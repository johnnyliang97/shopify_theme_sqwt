if(!customElements.get("quick-add")){class t extends HTMLElement{constructor(){super(),this.quickAddButtons=this.querySelectorAll(".product-card__quick-add-button"),this.quickAddButtonsWrappers=this.querySelectorAll(".product-variant-option-section:not(.hidden)"),this.wrapperIndex=0,this.selectedOptions=[],this.cartDrawer=document.querySelector("cart-drawer"),this.activatedWrappers=[],this.hiddenWrappers=this.querySelectorAll(".product-variant-option-section.hidden"),this.getVariantPreorderData()}getVariantPreorderData(){const t=this.querySelector("script[data-variant-preorder]");t&&(this.variantPreorderData=JSON.parse(t?.textContent))}connectedCallback(){this.init()}init(){this.quickAddButtonsWrappers.length<=1?this.quickAddButtons.forEach(t=>{"true"===t.dataset.available&&t.addEventListener("click",this.handleButtonClick.bind(this,t))}):(this.selectedOptions=new Array(this.quickAddButtonsWrappers.length),this.hiddenWrappers.forEach((t,e)=>{this.selectedOptions[e]=t.querySelector(".product-card__quick-add-button").dataset.optionValue}),this.getVariantsData(),this.quickAddButtonsWrappers.forEach((t,e)=>{const a=t.querySelectorAll(".product-card__quick-add-button");a.forEach(t=>{"true"===t.dataset.available&&t.addEventListener("click",this.handleShowNextWrapper.bind(this,e,a))})}))}handleShowNextWrapper(t,e,a){a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation(),this.selectedOptions[t+1]=a.currentTarget.dataset.optionValue;let r=t+1;if(r<this.quickAddButtonsWrappers.length&&(this.quickAddButtonsWrappers[r].classList.add("active-product-option"),this.activatedWrappers.push(this.quickAddButtonsWrappers[r]),e.forEach(t=>{t.classList.remove("product-option-active")}),a.currentTarget.classList.add("product-option-active"),this.checkLastOptionsAvailability(this.quickAddButtonsWrappers[r]),this.quickAddButtonsWrappers[t].querySelector(".product-card-quick-add-anchor").classList.remove("mobile-only"),this.quickAddButtonsWrappers[t].querySelector(".product-card-quick-add-anchor").classList.add("display-none-important")),t===this.quickAddButtonsWrappers.length-1){const{currentVariantId:t,currentVariantAvailable:e}=this.findCurrentVariantFromOptionRadioInputs(this.selectedOptions);t&&e&&this.addToCart(t,a.currentTarget,!0)}}findCurrentVariantFromOptionRadioInputs(t){let e=null,a="",r="",i=[];return this.variantsObj?.forEach(s=>{(s.options.join()===Object.values(t).join()||1===s.options.length&&0===i.length)&&(a=s.id,e=s.available,r=s.featured_media?.id||null)}),{currentVariantAvailable:e,currentVariantId:a,currentCheckedOptions:i,currentVariantMediaId:r}}getVariantsData(){const t=JSON.parse(this.closest("product-card")?this.closest("product-card").querySelector("[data-product-variants-json]").textContent:"[]");return(!t||0!==Object.keys(t).length)&&(this.variantsObj=t,t)}checkLastOptionsAvailability(t){const e=t.querySelectorAll(".product-card__quick-add-button"),a=[...this.selectedOptions];e.forEach(t=>{a.push(t.dataset.optionValue),this.variantsObj?.forEach(e=>{(e.options.join()===Object.values(a).join()||1===e.options.length&&0===a.length)&&(e.available?(t.classList.remove("strikethrough"),t.dataset.available="true"):(t.classList.add("strikethrough"),t.dataset.available="false"))}),a.pop()})}handleButtonClick(t,e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();const a=t.dataset.variantId;a&&this.addToCart(a,t)}async addToCart(t,e,a=!1){const r=e.querySelector(".button-text"),i=e.querySelector(".loading-spinner");try{this.toggleLoadingState(r,i,!0);const e=this.createFormData(t),a=await this.sendAddToCartRequest(e);if(!a.ok)throw new Error("Error adding to cart");const s=await a.json();console.log("data",s),this.updateCartUI(s)}catch(t){console.error("Error adding to cart:",t)}finally{this.toggleLoadingState(r,i,!1),a&&(this.selectedOptions=new Array(this.quickAddButtonsWrappers.length),this.wrapperIndex=0,this.activatedWrappers.forEach(t=>{t.classList.remove("active-product-option")}),this.quickAddButtonsWrappers.forEach(t=>{t.querySelector(".product-card-quick-add-anchor").classList.remove("display-none-important"),t.querySelector(".product-card-quick-add-anchor").classList.add("mobile-only")}),this.activatedWrappers=[],this.hiddenWrappers.forEach((t,e)=>{this.selectedOptions[e]=t.querySelector(".product-card__quick-add-button").dataset.optionValue}))}}createFormData(t){const e=new FormData;e.append("id",t),e.append("quantity",1);const a=this.variantPreorderData[t];if(a&&a.preorder)e.append("properties[_preorder]",a.value);else{const t=this.querySelector('input[name="properties[_preorder]"]');t&&e.append("properties[_preorder]",t.value)}if(this.cartDrawer){const t=this.cartDrawer.getSectionsToRender();t&&t.length>0&&(e.append("sections",t.map(t=>t.section).join(",")),e.append("sections_url",window.location.pathname))}return e}async sendAddToCartRequest(t){return fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",body:t})}updateCartUI(t){if(this.cartDrawer&&t.sections)try{this.cartDrawer.renderContents(t)}catch(t){console.warn("Error rendering cart drawer contents:",t)}document.dispatchEvent(new CustomEvent("cart:refresh"))}toggleLoadingState(t,e,a){e.classList.toggle("hidden",!a),t.style.opacity=a?0:1}}customElements.define("quick-add",t)}if(!customElements.get("quick-add-mobile-toggle")){class t extends HTMLElement{constructor(){super(),this.parent=this.closest(".product-card-options-outer"),this.anchor=this.parent.querySelector('[data-anchor="true"]')}connectedCallback(){this.addEventListener("click",this.handleClick),this.attachAnchor(this.anchor)}attachAnchor=t=>{t?.addEventListener("click",this.handleClick)};handleClick=t=>{t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation(),this.classList.toggle("active")}}customElements.define("quick-add-mobile-toggle",t)}